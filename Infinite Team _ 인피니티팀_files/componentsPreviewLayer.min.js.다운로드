define("componentsPreviewLayer",["lodash","coreUtils","santa-components","componentsCore","wixappsCore","previewExtensionsCore","wixappsClassics","wixappsBuilder","componentsPreviewExtensions","wix-ui-santa/stylable-preview.bundle","stylable-panel-drivers","stylable-santa-flatten","wix-ui-santa/wix-ui-santa.metadata.json.bundle"],function(e,t,n,i,o,r,s,a,p,c,l,u,d){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=519)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},12:function(e,t){e.exports=o},122:function(e,t){e.exports=a},184:function(e,t){e.exports=p},2:function(e,t){e.exports=n},20:function(e,t){e.exports=r},3:function(e,t){e.exports=i},519:function(e,t,n){var i,o;i=[n(184),n(0),n(20),n(520),n(521),n(522),n(524),n(526),n(529),n(533)],void 0===(o=function(e,t,n){"use strict";return{extendCompClasses:function(){e.extendCompClasses(),n.registrar.registerPreviewClasses()}}}.apply(t,i))||(e.exports=o)},520:function(e,t,n){var i,o;i=[n(0),n(20),n(2),n(70)],void 0===(o=function(e,t,n){"use strict";function i(){this.viewName_=this.props.compData.viewName,this.customizationsCount_=this.props.compData.appLogicCustomizations.length,this.appLogicCustomizations_=this.props.compData.appLogicCustomizations}var o={propTypes:{previewTooltipCallback:n.santaTypesDefinitions.RenderRealtimeConfig.previewTooltipCallback},componentDidUpdate:function(){i.call(this)},componentDidMount:function(){i.call(this)},isChanged:function(t){return this.viewName_!==t.compData.viewName||this.props.compProp.direction!==t.compProp.direction||this.customizationsCount_!==t.compData.appLogicCustomizations.length||!e.isEqual(this.appLogicCustomizations_,t.compData.appLogicCustomizations)}};t.registrar.registerCompExtension("wixapps.integration.components.AppPart",o)}.apply(t,i))||(e.exports=o)},521:function(e,t,n){var i,o;i=[n(0),n(20),n(122)],void 0===(o=function(e,t,n){"use strict";var i={propTypes:{views:n.appBuilderSantaTypesDefinitions.views},isChanged:function(t){var n=e.cloneDeep(t.views.Array.vars),i=!e.isEqual(this.viewVars,n);return this.viewVars=n,i}};t.registrar.registerCompExtension("wixapps.integration.components.AppPart2",i)}.apply(t,i))||(e.exports=o)},522:function(e,t,n){var i,o;i=[n(523)],void 0===(o=function(e){"use strict";if("undefined"!=typeof window&&window.document&&window.santaBase&&!window.editorBase&!window.document.querySelector("#viewerMainStyle")&&!window.document.querySelector('link[href$="viewer.css"]')){var t=window.document.createElement("LINK");t.setAttribute("rel","stylesheet"),t.setAttribute("href",window.santaBase+"/static/css/viewer.css"),window.document.head.appendChild(t);var n=window.document.createElement("style");n.setAttribute("rel","stylesheet"),n.innerHTML=e,window.document.head.appendChild(n)}}.apply(t,i))||(e.exports=o)},523:function(e,t){e.exports=c},524:function(e,t,n){var i,o;i=[n(20),n(525),n(12)],void 0===(o=function(e){"use strict";e.registrar.extendProxyClasses()}.apply(t,i))||(e.exports=o)},525:function(e,t,n){var i,o;i=[n(0),n(20)],void 0===(o=function(e,t){"use strict";var n={componentDidUpdate:function(){this._itemsPerPage=i.call(this)},componentWillReceiveProps:function(){this.state.currentPage>1&&function(){return this._itemsPerPage&&this._itemsPerPage!==i.call(this)}.call(this)&&this.setState({currentPage:1})}};function i(){return this.getCompProp("itemsPerPage")}t.registrar.registerProxyExtension("PaginatedList",n)}.apply(t,i))||(e.exports=o)},526:function(e,t,n){var i,o;i=[n(20),n(70),n(527),n(528)],void 0===(o=function(e){"use strict";e.registrar.extendLogicClasses()}.apply(t,i))||(e.exports=o)},527:function(e,t,n){var i,o;i=[n(0),n(20),n(1),n(70)],void 0===(o=function(e,t,n,i){"use strict";var o=n.blogAppPartNames;function r(e){var t=this.partApi.getPreviewTooltipCallback();t&&t(e.target.getBoundingClientRect(),"PREVIEW_TOOLTIP_GOTO_LIVE_SITE")}t.registrar.registerLogicExtension(o.SINGLE_POST,{startSelection:e.noop,toggleLikeForPost:r,sharePost:r,isReady:function(){var t=i.blogSinglePostPageLogicUtils.getSinglePost(this.partApi);return e.isEmpty(t)||(t=i.blogSinglePostPageLogicUtils.transformPostIfPreview.call(this,t,this.partApi),i.blogSinglePostPageLogicUtils.updatePageTitleAndMetaTags.call(this,t,this.partApi)),!0}})}.apply(t,i))||(e.exports=o)},528:function(e,t,n){var i,o;i=[n(0),n(20),n(1)],void 0===(o=function(e,t,n){"use strict";var i=n.blogAppPartNames;t.registrar.registerLogicExtension(i.RELATED_POSTS,{getViewVars:function(){return{isEditMode:!0}},isHeightResizable:function(){return!0}})}.apply(t,i))||(e.exports=o)},529:function(e,t,n){var i,o;i=[n(0),n(3),n(530),n(531),n(532)],void 0===(o=function(e,t,n,i,o){"use strict";var r="stylableRenderingAspect",s="/site.st.css";function a(t){this.siteAPI=t;var r=e.mapValues(o.components,function(t){return e.assign({},t,{snapshots:['<div style="height: 60px;width:140px;"/>']})}),a=n.StylableEditor;this.stylableEditorInstance=new a(e.assign(o,{components:r}),s),this.stylableEditorInstance.stylableDriver.registerJsModules(i.inlineModules),this.stylableEditorInstance.stylableDriver.registerTransformationPlugins(i.transformationPlugins),i.inlineModulesContext.setStaticMediaUrl(this.siteAPI.getSiteData().serviceTopology.staticMediaUrl),this.theme=[],this.stylableEditorInstance.stylableDriver.writeFile(s,""),this.componentPathMap={}}function p(e){return e+"_quickChange"}function c(e){return e+"_forceState"}return a.prototype={getStylableEditorInstance:function(){return this.stylableEditorInstance},transpileStylesheet:function(t,n,o,r){if(!t)return!1;var s=this.stylableEditorInstance.stylableDriver,a="/"+t.id+".st.css",p=e.get(t,["style","properties","$st-css"],""),c=t.id;return this.componentPathMap[o]=a,this.updateTheme(n),s.writeFile(a,i.addStylableDirectiveRules(p,r,{siteColors:!0,additionalJsModules:!0})),s.stylable.process(a).namespace=c,s.buildCSS({entries:[a],emitBuild:!1})},updateTheme:function(t){if(e.has(this.theme,"color")&&e.isEqual(t.color,this.theme.color))return!1;this.theme=t,this.stylableEditorInstance.stylableDriver.getSiteVarsDriver(s).setSiteColors(function(e){for(var t=Object.values(e).slice(11),n=t.length/5,i=[],o=0;o<5;o++)i.push(t.splice(0,n));return i}(this.theme.color))},getQuickChanges:function(e){return this.siteAPI.getAspectComponentData(r,p(e))},setQuickChanges:function(e,t,n){var i=this.getComponentStylesheet(e);if(i){var o="#"+e+i.getTargetSelector(t,!0);this.siteAPI.setAspectComponentData(r,p(e),{selector:o,declarationMap:n})}},revertQuickChanges:function(e){this.siteAPI.setAspectComponentData(r,p(e))},getComponentStylesheet:function(e){var t=this.componentPathMap[e];return this.stylableEditorInstance.stylableDriver.getStylesheet(t)},forceState:function(e,t){var i=n.getStateOverrideHints,o=n.STYLABLE_OVERRIDE_STATE_PREFIX,s=this.getComponentStylesheet(e);if(s){var a=i(s.getTargetSelector(t),o),p=a.stateAttribute,l=a.selectorToQuery;this.siteAPI.setAspectComponentData(r,c(e),{selector:l,stateAttribute:p})}},revertForceState:function(e){this.siteAPI.setAspectComponentData(r,c(e))},getForceState:function(e){return this.siteAPI.getAspectComponentData(r,c(e))}},t.siteAspectsRegistry.registerSiteAspect(r,a),{aspect:a,name:r}}.apply(t,i))||(e.exports=o)},530:function(e,t){e.exports=l},531:function(e,t){e.exports=u},532:function(e,t){e.exports=d},533:function(e,t,n){var i,o,r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&a.return&&a.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};i=[n(0),n(1),n(3),n(2),n(184)],void 0===(o=function(e,t,n,i,o){"use strict";var s=t.propsSelectorsUtils.createComponentSantaTypeFetcher,a=o.visibilityPlugins,p=a.fixedPositionPlugin,c=a.hiddenCompPropertyPlugin,l=a.appControllerPlugin,u="VISIBLE",d="HIDDEN",f="NONE",g=i.santaTypesDefinitions;function h(e,t){return"platform.components.AppController"!==t.structure.componentType||l({renderFlags:{componentViewMode:e.fetchSantaType(g.RenderFlags.componentViewMode,e,t)},isMobile:e.fetchSantaType(g.isMobileView,e,t),isVisible:e.fetchSantaType(g.AppController.isVisible,e,t),compType:t.structure.componentType})}var m={visibilityState:s(function(t,n){if(t.fetchSantaType(g.RenderRealtimeConfig.shouldHideComponent,t,n))return d;var i=p({compId:n.id,compLayout:n.structure.layout,renderFlags:{allowShowingFixedComponents:t.fetchSantaType(g.RenderFlags.allowShowingFixedComponents,t,n)}}),o=t.fetchSantaType(g.Component.compProp,t,n),r=e.get(o,"isHidden"),s=c({compProperties:o,compId:n.id,isHidden:r,renderFlags:{showHiddenComponents:t.fetchSantaType(g.RenderFlags.showHiddenComponents,t,n),ignoreComponentsHiddenProperty:t.fetchSantaType(g.RenderFlags.ignoreComponentHiddenProperty,t,n)?[n.id]:[]}}),a=h(t,n),l=t.siteAPI.getRenderFlag("isComponentVisible"),m=!!e.isUndefined(l)||l;return i&&a&&m?r&&s&&i&&a?u:f:d}),visibilityClasses:s(function(t,n){var i=e.get(n,"structure.layout.fixedPosition"),o=t.fetchSantaType(g.Component.compProp,t,n),s=e.get(o,"isHidden"),a=[g.RenderFlags.allowShowingFixedComponents,g.RenderFlags.showHiddenComponents,g.RenderFlags.ignoreComponentHiddenProperty,g.RenderFlags.ignoreComponentCollapsedProperty].map(function(e){return t.fetchSantaType(e,t,n)}),p=r(a,4),c=p[0],l=p[1],u=p[2],d=p[3],f=e.get(o,"isCollapsed"),m="editor"===t.fetchSantaType(g.RenderFlags.componentViewMode,t,n),y=h(t,n),v=f&&m&&!d,P=[];return!u&&function(e,t,n,i,o){return e&&n&&(!t||i)&&o}(s,i,l,c,y)&&P.push("hidden-comp-ghost-mode"),v&&P.push("collapsed-comp-mode"),P.join(" ")})};return n.santaTypesFetchersRegistry.registerFetchersNamespace("PreviewVisibility",m),{fetchers:m}}.apply(t,i))||(e.exports=o)},70:function(e,t){e.exports=s}})});
//# sourceMappingURL=componentsPreviewLayer.min.js.map